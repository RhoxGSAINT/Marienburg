
--Inital caravan forces

local rough_rider = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_boogschutter",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_privateers_dual_swords",
	"hkrul_privateers_dual_swords",
	"hkrul_mar_cav_rijders",
	"hkrul_mar_cav_rijders",
	"hkrul_mar_cav_rijders",
	"hkrul_mar_cav_rijders"
};
	
local inventor = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_boogschutter",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_privateers_dual_swords",
	"hkrul_privateers_dual_swords",
	"hkrul_mar_inf_handgun",
	"hkrul_mar_inf_handgun"
};
	
local clandestine = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_boogschutter",
	"wh2_dlc11_cst_inf_sartosa_free_company_0",
	"wh2_dlc11_cst_inf_sartosa_free_company_0",
	"wh3_main_ksl_inf_armoured_kossars_1",
	"wh3_main_ksl_inf_armoured_kossars_1",
	"wh3_main_ksl_inf_streltsi_0",
	"wh3_main_ksl_inf_kossars_0",
	"wh3_main_ksl_inf_kossars_0"
};
	
local favoured = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_crossbow",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_mar_inf_greatsword",
	"hkrul_mar_inf_greatsword",
	"hkrul_mar_inf_crossbow",
	"hkrul_mar_inf_crossbow",
	"hkrul_burgher"
};
	
local Solkan = {
    "hkrul_mar_cleansing_flame",
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_boogschutter",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_goedendagers",
	"hkrul_mar_inf_goedendagers"
};
	
local Former_Artillery_Officer = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_swords",
	"hkrul_mar_inf_swords",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_art_scheepskanon",
	"hkrul_mar_art_scheepskanon"
};
	
local Norscan_Heritage = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_boogschutter",
	"wh_dlc08_nor_mon_war_mammoth_0",
	"wh_dlc08_nor_inf_marauder_hunters_1",
	"wh_main_nor_inf_chaos_marauders_1",
	"wh_main_nor_inf_chaos_marauders_1",
	"hkrul_mar_inf_halberd",
	"wh_dlc08_nor_inf_marauder_berserkers_0"
};
	
local Griffon_Whisperer = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_boogschutter",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_knights_griffon",
	"hkrul_mar_knights_griffon"
};
	
local Dwarf_Ally = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_qual_great",
	"hkrul_mar_qual_great",
	"hkrul_mar_qual",
	"hkrul_mar_qual",
	"hkrul_mar_qual",
	"wh_main_dwf_inf_longbeards",
	"wh_main_dwf_inf_longbeards",
	"wh_main_dwf_art_organ_gun"
};
	
local Ogre_Ally = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_boogschutter",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_halberd",
	"wh3_main_ogr_inf_maneaters_0",
	"wh3_main_ogr_inf_maneaters_0",
	"wh3_main_ogr_inf_maneaters_1"
};
	
local Elf_Ally = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_halberd",
	"wh2_main_hef_inf_lothern_sea_guard_1",
	"wh2_main_hef_inf_lothern_sea_guard_1",
	"wh2_main_hef_inf_lothern_sea_guard_1",
	"wh2_main_hef_inf_lothern_sea_guard_1"
};
	
local Eastern_Idealist = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_boogschutter",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_halberd",
	"wh3_main_cth_inf_jade_warriors_1",
	"wh3_main_cth_inf_jade_warriors_1",
	"wh3_main_cth_inf_jade_warriors_1",
	"wh3_main_cth_inf_jade_warrior_crossbowmen_1",
	"wh3_main_cth_inf_jade_warrior_crossbowmen_1"
};

local Manann = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_boogschutter",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_halberd",
	"wh2_dlc11_cst_inf_sartosa_militia_0",
	"hkrul_mar_sons_of_manann",
	"hkrul_mar_sons_of_manann"
};
	
local Bretonnia = {
	"hkrul_mar_inf_boogschutter",
	"hkrul_mar_inf_boogschutter",
	"hkrul_burgher",
	"hkrul_burgher",
	"hkrul_mar_inf_crossbow",
	"wh_main_brt_cav_knights_of_the_realm",
	"wh_main_brt_cav_knights_of_the_realm",
	"wh_dlc07_brt_cav_knights_errant_0",
	"wh_dlc07_brt_cav_knights_errant_0"
};
	
local Teb = {
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_halberd",
	"hkrul_mar_inf_crossbow",
	"hkrul_mar_inf_crossbow",
	"hkrul_mar_inf_crossbow",
	"hkrul_mar_inf_crossbow"
};

local Cataph_Teb = {
	"teb_pikemen",
	"teb_pikemen",
	"teb_pavisiers",
	"teb_pavisiers",
	"teb_half_pikes",
	"teb_half_pikes",
	"teb_xbowmen",
	"teb_xbowmen"
};

local mixu_pirate_unit_list = {
	"mixu_emp_inf_pirate_deckhands_swords",
	"mixu_emp_inf_pirate_deckhands_swords",
	"mixu_emp_inf_pirate_deckhands_polearms",
	"mixu_emp_inf_buccaneers_great_axe",
	"mixu_emp_inf_buccaneers_sword_and_bombs",
	"mixu_emp_inf_gunnery_mob_pistols",
	"mixu_emp_art_carronade",
};


local pirate_unit_list = {
	"hkrul_privateers_dual_swords",
	"hkrul_privateers_dual_swords",
	"hkrul_privateers",
	"hkrul_privateers",
	"wh2_dlc11_cst_inf_sartosa_free_company_0",
	"wh2_dlc11_cst_inf_sartosa_militia_0",
	"hkrul_mar_art_scheepskanon"
};


function hkrul_mar_add_inital_force(caravan)
	
	out.design("Try to add inital force to caravan, based on trait")
	
	local force_cqi = caravan:caravan_force():command_queue_index();
	local lord_cqi = caravan:caravan_force():general_character():command_queue_index();
	local lord_str = cm:char_lookup_str(lord_cqi);
	
	if caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_cavalry") then
		for i=1, #rough_rider do
			cm:grant_unit_to_character(lord_str, rough_rider[i]);
		end
		--fully heal when returning
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_gunner") then
		for i=1, #inventor do
			cm:grant_unit_to_character(lord_str, inventor[i]);
		end
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_aristocratic") then
		for i=1, #favoured do
			cm:grant_unit_to_character(lord_str, favoured[i]); --should have xp/t innate skill
		end
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_reformed_criminal") then
		for i=1, #clandestine do
			cm:grant_unit_to_character(lord_str, clandestine[i]);
		end
		cm:add_experience_to_units_commanded_by_character(lord_str, 4)
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_solkan_zealot") then
		for i=1, #Solkan do
			cm:grant_unit_to_character(lord_str, Solkan[i]);
		end
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_former-artillery-officer") then
		for i=1, #Former_Artillery_Officer do
			cm:grant_unit_to_character(lord_str, Former_Artillery_Officer[i]);
		end
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_norscan_heritage") then
		for i=1, #Norscan_Heritage do
			cm:grant_unit_to_character(lord_str, Norscan_Heritage[i]);
		end
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_griffon-whisperer") then
		for i=1, #Griffon_Whisperer do
			cm:grant_unit_to_character(lord_str, Griffon_Whisperer[i]);
		end
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_dwarf-ally") then
		for i=1, #Dwarf_Ally do
			cm:grant_unit_to_character(lord_str, Dwarf_Ally[i]);
		end
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_ogre-ally") then
		for i=1, #Ogre_Ally do
			cm:grant_unit_to_character(lord_str, Ogre_Ally[i]);
		end
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_elf-ally") then
		for i=1, #Elf_Ally do
			cm:grant_unit_to_character(lord_str, Elf_Ally[i]);
		end
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_eastern-idealist") then
		for i=1, #Eastern_Idealist do
			cm:grant_unit_to_character(lord_str, Eastern_Idealist[i]);
		end
    elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_manann_zealot") then
		for i=1, #Manann do
			cm:grant_unit_to_character(lord_str, Manann[i]);
		end
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_bretonnia") then
		for i=1, #Bretonnia do
			cm:grant_unit_to_character(lord_str, Bretonnia[i]);
		end	
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_teb") then
        if vfs.exists("script/frontend/mod/cataph_teb.lua")then --you have Cataph's TEB installed! Here is a little gift for you.
            out("Rhox Mar: Giving Cataph units to the caravan")
            for i=1, #Cataph_Teb do
                cm:grant_unit_to_character(lord_str, Cataph_Teb[i]);
            end	
        else
            for i=1, #Teb do
                cm:grant_unit_to_character(lord_str, Teb[i]);
            end	
        end
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_privateer") then
        if vfs.exists("script/frontend/mod/mixu_frontend_le_darkhand.lua")then --you have Mixu's LL installed! Here is a little gift for you.
            out("Rhox Mar: Giving Mixu units to the caravan")
            for i=1, #mixu_pirate_unit_list do
                cm:grant_unit_to_character(lord_str, mixu_pirate_unit_list[i]);
            end	
        else
            for i=1, #pirate_unit_list do
                cm:grant_unit_to_character(lord_str, pirate_unit_list[i]);
            end	
        end	
	else
        for i=1, #Eastern_Idealist do
			cm:grant_unit_to_character(lord_str, Eastern_Idealist[i]);
		end
		out("*** Unknown Caravan Master ??? ***")
	end
end




function rhox_mar_finish_dilemma_unit_add(caravan)
    local dilemma_name = "rhox_mar_dilemma_final_reward"
    local dilemma_builder = cm:create_dilemma_builder(dilemma_name);
    local payload_builder = cm:create_payload();
    
    local marienburg_list = {
        {unit = "hkrul_mar_inf_handgun", count =2},
        {unit = "hkrul_mar_riverwarden", count =3},
        {unit = "hkrul_mar_inf_crossbow", count =3},
        {unit = "hkrul_privateers_dual_swords", count =2},
        {unit = "hkrul_privateers", count =2},
        {unit = "hkrul_mar_art_scheepskanon", count =1},
        {unit = "hkrul_mar_culverin", count =1},
        {unit = "hkrul_mar_handguns", count =2}
    };
    
    local normal_target_index = cm:random_number(#marienburg_list,1)
    payload_builder:add_unit(caravan:caravan_force(), marienburg_list[normal_target_index].unit, marienburg_list[normal_target_index].count, 0);
    dilemma_builder:add_choice_payload("FIRST", payload_builder);
    payload_builder:clear();
    
    
    local special_list = {
        {unit = "hkrul_mar_inf_handgun", count =3},
        {unit = "hkrul_mar_riverwarden", count =3},
        {unit = "hkrul_mar_inf_crossbow", count =3},
        {unit = "hkrul_mar_inf_halberd", count =3}
    }; --it means nothing just a failsafe
    
    
    
    if caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_cavalry") then
        special_list = {
            {unit = "wh3_main_ksl_cav_winged_lancers_0", count =2},
            {unit = "wh3_main_cth_cav_jade_lancers_0", count =2},
            {unit = "wh_main_emp_cav_empire_knights", count =2},
            {unit = "wh2_main_hef_cav_silver_helms_0", count =2},
            {unit = "wh_main_brt_cav_knights_of_the_realm", count =2},
            {unit = "wh2_dlc16_wef_cav_glade_riders_2", count =3}                  
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_gunner") then
        special_list = {
            {unit = "wh_main_emp_inf_handgunners", count =2},
            {unit = "wh_dlc04_emp_inf_free_company_militia_0", count =3},
            {unit = "wh_main_emp_cav_outriders_0", count =2},
            {unit = "wh_main_emp_cav_outriders_1", count =1},
            {unit = "wh2_dlc13_emp_veh_war_wagon_1", count =1},
            {unit = "wh2_dlc13_emp_veh_war_wagon_0", count =1}                  
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_aristocratic") then
        special_list = {
            {unit = "wh2_dlc13_emp_cav_pistoliers_ror_0", count =1},
            {unit = "wh_main_emp_inf_greatswords", count =1},
            {unit = "wh_main_emp_cav_empire_knights", count =2},
            {unit = "wh_main_emp_inf_swordsmen", count =2},
            {unit = "wh_main_emp_inf_handgunners", count =2}                  
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_reformed_criminal") then
        special_list = {
            {unit = "wh3_main_ksl_veh_light_war_sled_0", count =2},
            {unit = "wh3_main_ksl_veh_heavy_war_sled_0", count =1},
            {unit = "wh3_main_ksl_inf_kossars_1", count =3},
            {unit = "wh3_main_ksl_inf_tzar_guard_0", count =1},
            {unit = "wh3_main_ksl_inf_tzar_guard_1", count =1},
            {unit = "wh3_main_pro_ksl_inf_armoured_kossars_0", count =3}                  
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_solkan_zealot") then
        special_list = {
            {unit = "wh_dlc04_emp_inf_flagellants_0", count =2},
            {unit = "wh_dlc04_emp_cav_knights_blazing_sun_0", count =1},
            {unit = "wh_main_emp_veh_luminark_of_hysh_0", count =1},
            {unit = "wh_dlc04_emp_inf_flagellants_0", count =2}                 
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_former-artillery-officer") then
        special_list = {
            {unit = "hkrul_mar_culverin", count =1},
            {unit = "hkrul_mar_mortar", count =2},
            {unit = "wh_main_emp_veh_steam_tank", count =1},
            {unit = "hkrul_mar_hellstorm", count =1},
            {unit = "hkrul_mar_hellblaster", count =1}                  
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_norscan_heritage") then
        special_list = {
            {unit = "wh_dlc08_nor_inf_marauder_hunters_0", count =2},
            {unit = "wh_dlc08_nor_inf_marauder_hunters_1", count =2},
            {unit = "wh_dlc08_nor_cav_marauder_warwolves_chariot_0", count =1},
            {unit = "wh_dlc08_nor_inf_marauder_berserkers_0", count =2},
            {unit = "wh_dlc08_nor_inf_marauder_spearman_0", count =3},
            {unit = "wh_dlc08_nor_inf_marauder_champions_0", count =1}          
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_griffon-whisperer") then
        special_list = {
            {unit = "wh2_dlc13_emp_inf_huntsmen_0", count =2},
            {unit = "wh2_dlc13_emp_inf_archers_0", count =3},
            {unit = "wh_main_emp_cav_demigryph_knights_0", count =1},
            {unit = "wh_dlc07_brt_cav_royal_hippogryph_knights_0", count =1},
            {unit = "wh_main_emp_inf_crossbowmen", count =2}                  
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_dwarf-ally") then
        special_list = {
            {unit = "wh_main_dwf_inf_thunderers_0", count =2},
            {unit = "wh_main_dwf_inf_dwarf_warrior_0", count =3},
            {unit = "wh_main_dwf_inf_hammerers", count =1},
            {unit = "wh_main_dwf_art_cannon", count =1},
            {unit = "wh_main_dwf_inf_longbeards_1", count =2}          
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_ogre-ally") then
        special_list = {
            {unit = "wh3_main_ogr_inf_maneaters_0", count =1},
            {unit = "wh3_main_ogr_inf_maneaters_2", count =1},
            {unit = "wh3_main_ogr_mon_sabretusk_pack_0", count =2},
            {unit = "wh3_main_ogr_cav_mournfang_cavalry_0", count =1},
            {unit = "wh3_main_ogr_inf_ironguts_0", count =1},
            {unit = "wh3_main_ogr_inf_maneaters_3", count =1}                  
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_elf-ally") then
        special_list = {
            {unit = "wh2_main_hef_inf_lothern_sea_guard_1", count =2},
            {unit = "wh2_main_hef_inf_spearmen_0", count =3},
            {unit = "wh2_dlc15_hef_mon_arcane_phoenix_0", count =1},
            {unit = "wh2_dlc15_hef_inf_silverin_guard_0", count =1},
            {unit = "wh2_main_hef_mon_great_eagle", count =1}
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_eastern-idealist") then
        special_list = {
            {unit = "wh3_main_cth_inf_peasant_archers_0", count =3},
            {unit = "wh3_main_cth_inf_jade_warriors_1", count =2},
            {unit = "wh3_main_cth_inf_iron_hail_gunners_0", count =2},
            {unit = "wh3_main_cth_veh_sky_lantern_0", count =1},
            {unit = "wh3_main_cth_art_grand_cannon_0", count =1},
            {unit = "wh3_main_cth_inf_crane_gunners_0", count =1}          
        };
    elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_manann_zealot") then
        special_list = {
            {unit = "hkrul_mar_sons_of_manann", count =1},
            {unit = "wh2_dlc11_cst_inf_sartosa_free_company_0", count =2},
            {unit = "wh2_dlc11_cst_inf_sartosa_militia_0", count =2}
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_bretonnia") then
        special_list = {
            {unit = "wh_main_brt_inf_men_at_arms", count =3},
            {unit = "wh_main_brt_inf_spearmen_at_arms", count =3},
            {unit = "wh_dlc07_brt_inf_foot_squires_0", count =2},
            {unit = "wh_main_brt_art_field_trebuchet", count =1},
            {unit = "wh_main_brt_cav_pegasus_knights", count =1},
            {unit = "wh_dlc07_brt_cav_knights_errant_0", count =2},
            {unit = "wh_main_brt_cav_knights_of_the_realm", count =2},
            {unit = "wh_main_brt_cav_mounted_yeomen_1", count =2}          
        };
	elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_teb") then
        if vfs.exists("script/frontend/mod/cataph_teb.lua")then --you have Cataph's TEB installed! Here is a little gift for you.
            special_list = {
                {unit = "teb_galloper", count =1},
                {unit = "teb_half_pikes", count =2},
                {unit = "teb_duellists", count =2},
                {unit = "teb_light_cannon", count =1},
                {unit = "teb_pikemen", count =2},
                {unit = "teb_xbowmen", count =2}
            };
        else
            special_list = {
                {unit = "hkrul_mar_inf_handgun", count =2},
                {unit = "hkrul_mar_riverwarden", count =3},
                {unit = "hkrul_mar_inf_crossbow", count =3},
                {unit = "hkrul_privateers_dual_swords", count =2},
                {unit = "hkrul_privateers", count =2},
                {unit = "hkrul_mar_art_scheepskanon", count =1},
                {unit = "hkrul_mar_culverin", count =1},
                {unit = "hkrul_mar_handguns", count =2}
            };
        end
    elseif caravan:caravan_master():character_details():has_skill("hkrul_skill_innate_mar_caravan_master_privateer") then
        if vfs.exists("script/frontend/mod/mixu_frontend_le_darkhand.lua") then --you have Mixu's LL installed! Here is a little gift for you.
            special_list = {
                {unit = "mixu_emp_inf_pirate_deckhands_swords", count =2},
                {unit = "mixu_emp_inf_pirate_deckhands_swords", count =2},
                {unit = "mixu_emp_inf_pirate_deckhands_polearms", count =2},
                {unit = "mixu_emp_inf_buccaneers_great_axe", count =1},
                {unit = "mixu_emp_inf_buccaneers_sword_and_bombs", count =1},
                {unit = "mixu_emp_inf_gunnery_mob_pistols", count =1},
                {unit = "mixu_emp_art_carronade", count =1},
            };
        else
            special_list = {
                {unit = "wh2_dlc11_cst_inf_sartosa_militia_0", count =3},
                {unit = "wh2_dlc11_cst_inf_sartosa_free_company_0", count =3},
                {unit = "hkrul_privateers_dual_swords", count =2},
                {unit = "hkrul_privateers", count =2},
                {unit = "hkrul_mar_art_scheepskanon", count =1},
            };
        end	

	else
		out("*** Unknown Caravan Master ??? ***")
	end
	
	local target_index = cm:random_number(#special_list,1)
	payload_builder:add_unit(caravan:caravan_force(), special_list[target_index].unit, special_list[target_index].count, 0);
    dilemma_builder:add_choice_payload("SECOND", payload_builder);
    
    dilemma_builder:add_target("default", caravan:caravan_force());
    
    out.design("Triggering dilemma:"..dilemma_name)
    cm:launch_custom_dilemma_from_builder(dilemma_builder, caravan:caravan_force():faction());
end
